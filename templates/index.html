{% extends "base.html" %}
{% block title %}Messages{% endblock %}

{% block content %}
<h3 class="mb-3">Messages</h3>

<form id="msgForm" class="mb-4">
  <div class="input-group">
    <input type="text" class="form-control" name="new_message" placeholder="Enter a message..." required>
    <button class="btn btn-primary">Submit</button>
  </div>
</form>

<ul class="list-group">
  {% for m in messages %}
    <li class="list-group-item">{{ m[0] }}</li>
  {% endfor %}
</ul>

<script>
document.getElementById("msgForm").addEventListener("submit", async (e) => {
  e.preventDefault();
  const formData = new FormData(e.target);

  const resp = await fetch("/submit", {
    method: "POST",
    body: formData
  });

  const data = await resp.json();
  if (data.message) location.reload();
});
</script>

{% endblock %}
